<!DOCTYPE html>
<html lang="en">

<head>
   <!-- Required meta tags -->
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <link rel="shortcut icon" href="../favicon.ico" />
   <title>Yezz - Programa de embajadores</title>
   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="../css/bootstrap.min.css">
   <!-- Meterial Icon CSS -->
   <link rel="stylesheet" href="../css/materialdesignicons.min.css">
   <!-- Material CSS -->
   <link rel="stylesheet" href="../css/material.min.css">
   <!-- Ripples CSS -->
   <link rel="stylesheet" href="../css/ripples.min.css">
   <!-- Owl Carousel CSS -->
   <link rel="stylesheet" href="../css/owl.carousel.css">
   <!-- Magnific Popup -->
   <link rel="stylesheet" href="../css/magnific-popup.css">
   <!-- Slicknav CSS -->
   <link rel="stylesheet" href="../css/slicknav.css">
   <!-- Animate CSS -->
   <link rel="stylesheet" href="../css/animate.css">
   <!-- Style CSS -->
   <link rel="stylesheet" href="../css/style.css">
   <!-- Responsive CSS -->
   <link rel="stylesheet" href="../css/responsive.css">
   <!-- Color CSS Styles  -->
   <link rel="stylesheet" type="text/css" href="../css/colors/indigo.css" media="screen" />
   <!-- add the shim first for compatibility with older browsers -->
	<script type="text/javascript" src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.mini.min.js"></script>
	<!-- <script type="text/javascript" src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script> -->
   <script type="text/javascript" src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
   <!-- <script type="text/javascript" src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script> -->

   <!-- <script src="https://cdn.sheetjs.com/xlsx-0.19.1/package/dist/xlsx.zahl.js"></script> -->

	<!-- <script type="text/javascript" src="./js/lib/shim.min.js"></script> -->
	<!-- after the shim is referenced, add the library -->
	<!-- <script type="text/javascript" src="./js/lib/xlsx.full.min.js"></script> -->
	<!-- <script type="text/javascript" src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script> -->
   <style>
      .coli {
         width: 50px;
      }
   </style>
</head>

<body onload="inicio()">
   <!-- Header Start -->
   <header id="header">
      <nav class="navbar navbar-expand-lg fixed-top scrolling-navbar nav-bg">
         <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
               <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar"
                  aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="mdi mdi-menu"></span>
                  <span class="mdi mdi-menu"></span>
                  <span class="mdi mdi-menu"></span>
               </button>
               <a class="navbar-brand" href="./index.html">
                  <img style="height: 50px; width: 225px;" src="../images/LOGO.png" alt=""></a>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar">
               <ul class="navbar-nav mr-auto w-100 justify-content-end">
                  <li class="nav-item active">
                     <a class="nav-link" href="./principal.html">
                        Dashboard
                     </a>
                  </li>
                  <li class="nav-item dropdown">
                     <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">
                        Administración del sistema
                     </a>
                     <ul class="dropdown-menu">
                        <li><a href="./principal.html">Volver</a></li>
                        <li>
                           <hr class="dropdown-divider">
                        </li>
                        <!-- <li><a class="dropdown-item" href="./ejecutivos.html">Ejecutivos</a></li> -->
                        <!-- <li>
                           <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="./candidatos.html">Solicitudes por aprobar</a></li>
                        <li><a class="dropdown-item" href="./embajadores.html">Embajadores</a></li>
                        <li>
                           <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="./modelos.html">Modelos de teléfono y comisión</a></li>
                        <li><a class="dropdown-item" href="./imeis.html">Carga de IMEIS</a></li> -->
                        <li><a class="dropdown-item" href="./index.html">Cerrar sesión</a></li>
                     </ul>
                  </li>
               </ul>
            </div>
         </div>
         <!-- Mobile Menu Start -->
         <ul class="wpb-mobile-menu">
            <li>
               <a class="active" href="./principal.html">
                  Dashboard
               </a>
            </li>
            <li>
               <a href="#">
                  Administración del sistema
               </a>
               <ul class="dropdown">
                  <li><a href="./principal.html">Volver</a></li>
                  <li>
                     <hr class="dropdown-divider">
                  </li>
                  <li><a href="./index.html">Cerrar sesión</a></li>
               </ul>
            </li>
         </ul>
         <!-- Mobile Menu End -->
      </nav>
   </header>
   <!-- Header End -->

   <!-- Call to action Section -->
   <section class="call-to-action-section">
      <div class="container">
         <div class="row justify-content-between">
         </div>
      </div>
   </section>
   <!-- Call to action Section End -->

   <!-- Welcome Section Start -->


   <!-- Contact Us Section -->
   <section id="registro1" class="Material-contact-section section-padding section-dark">
      <div class="container">
         <div class="row">
            <!-- Section Titile -->
            <div class="col-md-12 wow animated fadeInLeft" data-wow-delay=".2s">
               <h2 class="section-title">Comisiones totales por fecha</h2>
            </div>
         </div>
         <div class="row">
            <!-- form -->
            <div class="col-md-12 wow animated fadeInRight" data-wow-delay=".2s">
               <form class="shake" role="form" method="post" id="contactForm" name="contact-form"
                  data-toggle="validator">
                  <div class="row">
                     <!-- Nombres -->
                     <div class="col-sm-4 form-group label-floating">
                        <label class="control-label" for="desde">Fecha desde</label>
                        <input class="form-control" id="desde" type="date" name="desde" required
                           data-error="Por favor introduce la fecha inicial" />
                     </div>
                     <div class="col-sm-4 form-group label-floating">
                        <label class="control-label" for="hasta">Fecha hasta</label>
                        <input class="form-control" id="hasta" type="date" name="hasta" required
                           data-error="Por favor introduce la fecha final" />
                     </div>
                  </div>
                  <div class="row">
                     <!-- Form Submit -->
                     <div class="form-submit mt-5">
                        <button class="btn btn-common" type="submit" id="form-submit" onclick="busqueda()"><i
                              class="material-icons mdi mdi-send"></i> Enviar</button>
                        <div id="msgSubmit" class="h3 text-center hidden"></div>
                        <div class="clearfix"></div>
                     </div>
                  </div>
               </form>
            </div>
         </div>

         <div class="row">
            <!-- Section Titile -->
            <div class="col-md-12 mt-3 contact-widget-section2 wow animated fadeInLeft" data-wow-delay=".2s">
               <table class="table table-striped" id="exportar">
                  <thead>
                     <tr>
                        <th class="coli" style="cursor: pointer;" onclick="colapsa('n0a')">*</th>
                        <th class="coli" style="cursor: pointer;" onclick="colapsa('n1d')">D</th>
                        <th class="coli" style="cursor: pointer;" onclick="colapsa('n2g')">G</th>
                        <th class="coli" style="cursor: pointer;" onclick="colapsa('n3t')">T</th>
                        <th style="cursor: pointer;" onclick="colapsa('n4e')">Embajador</th>
                        <th>IMEI</th>
                        <th>Puntos</th>
                        <th>Comision Ganada</th>
                        <th>Pagada</th>
                        <th>Pendiente</th>
                     </tr>
                  </thead>
                  <tbody id="tabla">
                     <tr>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                        <td>a</td>
                     </tr>
                  </tbody>
               </table>
               <!-- Linea de botones -->
               <div class="mt-5">
                  <button class="btn btn-common" type="submit" id="btnexcel" onclick="excel()">Exportar a Excel</button>
               </div>
            </div>
         </div>
      </div>
   </section>
   <script>
      function excel() {
         // /* Create worksheet from HTML DOM TABLE */
         // var wb = XLSX.utils.table_to_book(document.getElementById("detalles"));
         // /* Export to file (start a download) */
         // XLSX.writeFile(wb, "detalle.xlsx");
         
         worksheet = XLSX.utils.json_to_sheet(registrosx);
         workbook = XLSX.utils.book_new();
         XLSX.utils.book_append_sheet(workbook, worksheet, "detalles");
         XLSX.writeFile(workbook, 'Detalles.xlsx', {ignoreEC: false} );
         
         /*
         // function exportTableToExcel(tableID, filename = ''){
         var downloadLink;
         var dataType = 'application/vnd.ms-excel';
         var tableSelect = document.getElementById("exportar");
         var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
         
         // Specify file name
         filename = 'Detalles.xls';
         
         // Create download link element
         downloadLink = document.createElement("a");
         
         document.body.appendChild(downloadLink);
         
         if(navigator.msSaveOrOpenBlob){
            var blob = new Blob(['ufeff', tableHTML], {
                  type: dataType
            });
            navigator.msSaveOrOpenBlob( blob, filename);
         }else{
            // Create a link to the file
            downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
         
            // Setting the file name
            downloadLink.download = filename;
            
            //triggering the function
            downloadLink.click();
         }
         */
      }
   </script>
   <!-- Contact Us Section End -->

   <!--Footer-->
   <footer class="page-footer center-on-small-only  pt-0 footer-widget-container">
      <!--Footer Links-->
      <div class="container pt-7 mb-7">
         <div class="row" style="justify-content: center;">
            <!--First column-->
            <div class="col-md-12 col-lg-12 col-xl-12 footer-contact-widget">
               <p style="text-align: center;">
                  <img style="height: auto; width: 100%;" src="../images/registro.jpg" alt="">
               </p>
            </div>
            <!--/.First column-->

         </div>
      </div>
      <!--/.Footer Links-->

      <!-- Copyright-->
      <div class="footer-copyright">
         <div class="container">
            <div class="row">
               <div class="col-md-12 text-center">
                  <p>Desarrollado por <a style="color: white; text-decoration: underline;"
                        href="https://linktree.com/sgcvzla">SGC Consultores C.A.</a></p>
               </div>
            </div>
         </div>
      </div>
      <!--/.Copyright -->

   </footer>
   <!--/.Footer-->


   <!-- Back To Top -->
   <a href="#" class="back-to-top">
      <div class="ripple-container"></div>
      <i class="mdi mdi-arrow-up">
      </i>
   </a>

   <!-- Preloader -->
   <div id="preloader">
      <div class="loader" id="loader-1"></div>
   </div>
   <!-- End Preloader -->

   <!-- Optional JavaScript -->
   <script src="../js/jquery-min.js"></script>
   <script src="../js/popper.min.js"></script>
   <script src="../js/bootstrap.min.js"></script>

   <script src="../js/jquery.mixitup.min.js"></script>
   <script src="../js/jquery.inview.js"></script>
   <script src="../js/jquery.counterup.min.js"></script>
   <script src="../js/scroll-top.js"></script>
   <script src="../js/smoothscroll.js"></script>
   <script src="../js/material.min.js"></script>
   <script src="../js/ripples.min.js"></script>
   <script src="../js/owl.carousel.min.js"></script>
   <script src="../js/form-validator.min.js"></script>
   <script src="../js/contact-form-script.min.js"></script>
   <script src="../js/wow.js"></script>
   <script src="../js/jquery.vide.js"></script>
   <script src="../js/jquery.magnific-popup.min.js"></script>
   <script src="../js/jquery.slicknav.js"></script>
   <script src="../js/main.js"></script>
   <script src="../js/funciones.js"></script>
   <script src="./js/comisionestotalesporfecha.js"></script>
</body>

</html>